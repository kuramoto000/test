<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<style>
		main{
			min-height: 100vh;
			background-color: whitesmoke;
		}
		ul{
			display: flex;
			/* flex-direction: column; */
			padding: 20px 20px 100px;
			overflow: hidden;
		}
		li{
			width: 25px;
			border-radius: 10px;
			list-style: none;
			font-size: 20px;
			font-weight: bold;
			padding: 40px;
			/* opacity: 0; */
		}
		li.js-fadeIn{
			transform-origin: bottom;
			transform: rotateX(90deg);
		}
		li.show{
			transition-duration: 1s;
			transform: rotateX(0);
			opacity: 1;
		}
		li.js-change{
			transition-duration: 5s;
			transition-timing-function: ease-in-out;
			position: relative;
			top: -140px;
		}
		li+li{
			/* margin-top: 10px; */
			margin-left: 10px;
		}
		.orange{background-color: orange;}
		.green{background-color: greenyellow;}
		.red{background-color: red;}
		.yellow{background-color: yellow;}
		.gray{background-color: gray;}
		.pink{background-color: pink !important;}
	</style>
</head>
<body>
	<main>
		<h2>要素を時間差でfadeInする</h2>
		<p class="detail">jQuery使用。<br>queueのコールバック関数にaddClassを入れると、<br>時間差でclassを付与することができる。</p>
		<div class="test-01">
			<button href="" id="click">click!</button>
			<button href="" id="hide">hide!</button>
			<ul>
				<li class="js-fadeIn orange">１</li>
				<li class="js-fadeIn green">２</li>
				<li class="js-fadeIn red">３</li>
				<li class="js-fadeIn yellow">４</li>
				<li class="js-fadeIn gray">５</li>
				<li class="js-fadeIn pink">６</li>
			</ul>
		</div>
		<div class="test-02">
			<button href="" id="change">change!</button>
			<ul>
				<li class="js-change orange">１</li>
				<li class="js-change green">２</li>
				<li class="js-change red">３</li>
				<li class="js-change yellow">４</li>
				<li class="js-change gray">５</li>
				<li class="js-change pink">６</li>
			</ul>
		</div>
	</main>
	<footer><a href="./index.html">戻る。</a></footer>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<script>
		function fadeIn(){
			$('.js-fadeIn').each(function(i){
				console.log('count = ' + i);
				let $this = $(this);
				let delay = 100;
				console.log('this = ' + this);
				// $this.delay(i * delay).fadeIn(400);
				$this.delay(i * delay).queue(function(next){
					$this.addClass('show');
					next();
				});
			})
		};

		function scrollFadeIn(){
			$('.js-fadeIn').each(function(i){
				const WINDOW_HEIGHT = $(window).scrollTop();
				const TARGET_HEIGHT = $(this).offset().top - 300;
				console.log('window_height =' + WINDOW_HEIGHT);
				console.log('target_height =' + TARGET_HEIGHT);
				if( WINDOW_HEIGHT > TARGET_HEIGHT){
					$(this).addClass('in');
					$('.js-fadeIn.in').each(function(i){
						$(this).delay(i * 100).queue(function(next){
							$(this).addClass('show');
							next();
						})
					})
				}
			})
		}

		function changeColor(){
			$('.js-change').each(function(i){
				// let num = Math.floor(Math.random() * Math.floor(5));
				// let delay = num * 100;
				let delay = 200;
				$(this).delay(i * delay).animate({ top : '0' }, 300);
				$(this).delay(i * delay).queue(function(next){
					$(this).css('transform', 'rotate(1080deg)');
					next();
				})
				$(this).delay(i * delay).queue(function(next){
					$(this).addClass('pink');
					next();
				})
			})
		}

		$(window).on('scroll', function(){
			scrollFadeIn();
		})

		$('#click').on('click', function(){
			fadeIn();
		});

		$('#hide').on('click', function(){
			// $('.js-fadeIn').fadeOut();
			$('.js-fadeIn').removeClass('show');
		});

		$('#change').on('click', function(){
			changeColor();
		});

	</script>
</body>
</html>

