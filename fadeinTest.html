<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<style>
		main{
			min-height: 100vh;
			background-color: whitesmoke;
		}
		ul{
			display: flex;
			/* flex-direction: column; */
			/* padding: 20px 20px 100px; */
			/* overflow: hidden; */
		}
		li{
			width: 25px;
			border-radius: 10px;
			list-style: none;
			font-size: 20px;
			font-weight: bold;
			padding: 40px;
			transform-origin: bottom;
			transform: rotateX(90deg);
			/* opacity: 0; */
		}
		li.show{
			transition-duration: 1s;
			transform: rotateX(0);
			opacity: 1;
		}
		li+li{
			/* margin-top: 10px; */
			margin-left: 10px;
		}
		.orange{background-color: orange;}
		.green{background-color: greenyellow;}
		.red{background-color: red;}
		.yellow{background-color: yellow;}
		.gray{background-color: gray;}
		.pink{background-color: pink;}
	</style>
</head>
<body>
	<main>
		<h2>要素を時間差でfadeInする</h2>
		<p class="detail">jQuery使用。<br>queueのコールバック関数にaddClassを入れると、<br>時間差でclassを付与することができる。</p>
		<button href="" id="click">click!</button>
		<button href="" id="hide">hide!</button>
		<ul>
			<li class="js-fadeIn orange">１</li>
			<li class="js-fadeIn green">２</li>
			<li class="js-fadeIn red">３</li>
			<li class="js-fadeIn yellow">４</li>
			<li class="js-fadeIn gray">５</li>
			<li class="js-fadeIn pink">６</li>
		</ul>
	</main>
	<footer><a href="./index.html">戻る。</a></footer>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<script>
		function fadeIn(){
			$('.js-fadeIn').each(function(i){
				console.log('count = ' + i);
				let $this = $(this);
				let delay = 100;
				console.log('this = ' + this);
				// $this.delay(i * delay).fadeIn(400);
				$this.delay(i * delay).queue(function(next){
					$this.addClass('show');
					next();
				});
			})
		};

		function scrollFadeIn(){
			$('.js-fadeIn').each(function(i){
				const WINDOW_HEIGHT = $(window).scrollTop();
				console.log('window_height =' + WINDOW_HEIGHT);
				const TARGET_HEIGHT = $(this).offset().top - 300;
				console.log('target_height =' + TARGET_HEIGHT);
				let $target = [];
				if( WINDOW_HEIGHT > TARGET_HEIGHT){
					$(this).addClass('in');
					$('.js-fadeIn.in').each(function(i){
						$(this).delay(i * 100).queue(function(next){
							$(this).addClass('show');
							next();
						})
					})
				}
			})
		}

		$(window).on('scroll', function(){
			scrollFadeIn();
		})

		$('#click').on('click', function(){
			fadeIn();
			return false;
		});

		$('#hide').on('click', function(){
			// $('.js-fadeIn').fadeOut();
			$('.js-fadeIn').removeClass('show');
			return false;
		});
	</script>
</body>
</html>

